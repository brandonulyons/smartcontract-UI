const ethers = require('ethers')
const decodeTxReturn = require('decodeTxReturn')

module.exports = decodeTxData

function decodeTxData (opts) {

  var iface = new ethers.utils.Interface(opts.solcMetadata.output.abi)
  var fun = opts.contract.interface.functions[opts.fnName]
  var types
  var result

  if (opts.tag === 'input') {
    types =  fun.inputs
    var tx = { data: opts.data }
    result = iface.parseTransaction(tx).args
  }
  else if (opts.tag === 'output') {
    types =  fun.outputs
    result = opts.transaction
  }

  var decodedArgs = decodeTxReturn(result, types)
  return decodedArgs
}

function getTypes (data) {
  var types = []
  for (var i = 0; i<data.length; i++) types.push(fnInputs[i].type)
  return types
}
